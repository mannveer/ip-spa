
<div class="homepage">
  <!-- <router-outlet></router-outlet> -->

  <div class="page-heading">
    Files available as on {{ currentDate | date: 'MMMM d, y' }}
  </div>

  <div class="search-container">
    <div class="search-bar">
      <input
        type="text"
        placeholder="Search files..."
        [(ngModel)]="searchQuery"
        (input)="onSearchInput($event)"
        (focus)="showSuggestions = true"
        (blur)="hideSuggestions()"
        aria-label="Search files"
      />
      <button *ngIf="searchQuery" class="icon-button clear-icon" (click)="clearSearch()" aria-label="Clear search">
        <mat-icon>close</mat-icon>
      </button>
      <button class="icon-button search-icon" aria-label="Search">
        <mat-icon>search</mat-icon>
      </button>
      <button class="icon-button filter-button" (click)="toggleFilters()" aria-label="Filter files">
        <mat-icon>filter_list</mat-icon>
      </button>
    </div>
    <div class="suggestions" [@suggestionsState]="showSuggestions ? 'visible' : 'hidden'">
      <ul>
        <li *ngFor="let file of filteredFiles" (click)="selectSuggestion(file)">
          {{ file.originalfilename }}
        </li>
      </ul>
    </div>

    <!-- Filter Section with Animation -->
    <div class="filter-container" [@filterState]="showFilters ? 'expanded' : 'collapsed'">
      <div class="filter-header">
        <h3>Filter Files</h3>
        <button class="apply-button" (click)="applyFilters()">Apply Filters</button>
      </div>
      <div class="filter-options">
        <div class="filter-item">
          <label>Price:</label>
          <select [(ngModel)]="filterCriteria.price">
            <option value="">All</option>
            <option *ngFor="let price of priceOptions" [value]="price">{{ price | currency: 'INR' }}</option>
          </select>
        </div>
        <div class="filter-item">
          <label>Type:</label>
          <select [(ngModel)]="filterCriteria.type">
            <option value="">All</option>
            <option *ngFor="let type of typeOptions" [value]="type">{{ type }}</option>
          </select>
        </div>
        <div class="filter-item">
          <label>Date Added:</label>
          <select [(ngModel)]="filterCriteria.dateAdded">
            <option value="">All</option>
            <option *ngFor="let date of dateOptions" [value]="date">{{ date | date }}</option>
          </select>
        </div>
        <div class="filter-item">
          <label>Design Type:</label>
          <select [(ngModel)]="filterCriteria.designType">
            <option value="">All</option>
            <option *ngFor="let designType of designTypeOptions" [value]="designType">{{ designType }}</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <div class="file-list">
    <div class="file-item" *ngFor="let file of filteredFiles" (click)="openFileDetails(file, $event)">
      <div class="file-preview">
        <img
          [src]="file.previewUrl"
          alt="{{ file.originalfilename }}"
          (load)="onImageLoad(file)"
          (error)="onImageError(file)"
        />
      </div>
      <div class="file-info">
        <span class="file-name">{{ file.originalfilename }}</span>
        <!-- <span class="file-type">{{ file.mimetype }}</span> -->
        <span class="file-type">{{ file.price !== 0 ? (file.price | currency:'INR') : 'Free' }}</span>
            </div>
      <button class="buy-button" (click)="onBuyAndDownload(file, $event); $event.stopPropagation()">
        {{ file.price === 0 ? 'Download' : 'Buy and download' }}
      </button>
    </div>
  </div>
  <router-outlet></router-outlet>
</div>
